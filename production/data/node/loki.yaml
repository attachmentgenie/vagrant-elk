---
classes:
 - roles::logging
profiles::logging::loki: true
profiles::logging::loki::auth_enabled: false
profiles::logging::loki::ingester_config_hash:
  ingester:
    lifecycler:
      address: 127.0.0.1
      ring:
        kvstore:
          store: inmemory
        replication_factor: 1
      final_sleep: 0s
    chunk_idle_period: 5m
    chunk_retain_period: 30s
profiles::logging::loki::limits_config_hash:
  limits_config:
    enforce_metric_name: false
    reject_old_samples: true
    reject_old_samples_max_age: 168h
profiles::logging::loki::schema_config_hash:
  schema_config:
    configs:
      - from: '2020-05-15'
        store: boltdb
        object_store: filesystem
        schema: v11
        index:
          prefix: index_
          period: 168h
profiles::logging::loki::server_config_hash:
  server:
    http_listen_port: 3100
profiles::logging::loki::storage_config_hash:
  storage_config:
    boltdb:
      directory: /usr/local/loki_data/index
    filesystem:
      directory: /usr/local/loki_data/chunks
profiles::metrics::grafana: true
profiles::metrics::grafana::http_addr: '%{::ipaddress_eth1}'
profiles::metrics::grafana::manage_repo: true
profiles::monitoring::logstash: false
profiles::monitoring::promtail: true
profiles::monitoring::promtail::client_url: http://localhost:3100/loki/api/v1/push
profiles::website::nginx: true
profiles::website::nginx::proxies:
  loki.logging.vagrant:
    proxy_url: 'http://%{::ipaddress_eth1}:3000'
